# NBT to JSON Predicate Converter

## Описание
Этот проект предоставляет инструменты для чтения файлов в формате NBT (Named Binary Tag), преобразования их в JSON-предикаты Minecraft. Система поддерживает работу с несжатыми и сжатыми (GZip) NBT-файлами.
*Проект протестирован на nbt файлах версии Minecraft 1.21.X, однако насколько я знаю они особо не менялись с версии 1.13*

## Функционал
- **Чтение NBT-файлов:** Класс `NBTReader` для парсинга структурированных данных NBT.
- **Преобразование в JSON-предикат:** Функция преобразования данных NBT в формат JSON, совместимый с Minecraft предикатами.
- **Ротация предикатов:** Модуль для поворота данных предикатов на 90 градусов.

## Использование
Проект подготовлен для использования 'из коробки' для случая "мне надо преобразовать структуру в предикат, не зависящий от направления постройки". 

### Чтение NBT-файла и преобразование в JSON-предикат
Скрипт `from_nbt_to_predicate.py` преобразовывает NBT-файл в JSON-предикат, который проверяет правильна ли построена структура.
**Важно!** Предикаты на выходе чувствительны к следующим состояниям блоков: `half`, `type`, `waterlogged`, `shape`, `facing`, `open`.

**Пример использования:**
```bash
python from_nbt_to_predicate.py <путь к NBT-файлу> <центр X> <центр Y> <центр Z>
```
- `<путь к NBT-файлу>` — путь к файлу NBT.
- `<центр X>`, `<центр Y>`, `<центр Z>` — опциональные 'центр постройки' (по умолчанию `[0, 0, 0]`). При проверки предиката структура проверяется от центрального блока.
Таким образом скрипт выведет предикат в консоль. Если же вы хотите записать предикат в файл, то можете использовать запись через '>', пример:
```bash
python from_nbt_to_predicate.py example.nbt 0 1 0 > predicate.json
```

### Ротация JSON-предикатов
Вы также можете использовать модуль поворота отдельно чтобы сделать свой предикат нечуствительным к направлению постройки (*Направление блоков так-же вращается вместе с постройкой!*)
Скрипт `rotate.py` выполняет поворот предикатов на 90 градусов (3 раза), создавая набор предикатов для всех возможных ориентаций.

**Пример использования:**
```bash
python rotate.py <входной JSON-файл> <выходной JSON-файл> [-t]
```
- `<входной JSON-файл>` — путь к исходному JSON-файлу.
- `<выходной JSON-файл>` — путь для сохранения результата.
- `-t` — (опционально) используется для предикатов вида: `{"condition": "minecraft:all_of/any_of", "terms": [...]}`. Если же ваш предикат является простым списком предикатов, то флаг `-t` ставить не стоит.

### Пример кода
Вы также можете использовать эти модули в python, если 'стандартный' метод использования вам не подходит:
#### Преобразование NBT в JSON
```python
import nbtreader, json

data = nbtreader.read_data_from_nbt_file("example.nbt")
json_predicate = nbtreader.to_predicate(data, offset=[0, 0, 0]) # Это создаст предикат, чуствительный к направлению
print(json.dumps(json_predicate, indent=4))
```

#### Ротация предикатов
```python
import rotate

with open("predicate.json") as file:
    predicate = json.load(file)

rotated_predicate = rotate.rotate_predicate(predicate) # повернёт предикат 1 раз на 90 градусов и вернёт новый
print(rotated_predicate)
```

## Структура проекта
- `nbtreader.py`: Модуль чтения и парсинга NBT-файлов, преобразования их в предикаты Minecraft.
- `rotate.py`: Модуль для поворота предикатов.
- `from_nbt_to_predicate.py`: Основной скрипт для преобразования NBT в JSON-предикат с возможностью задания центра структуры, относительно которого будет проверяться предикат.

## Зависимости
Проект использует только стандартную библиотеку Python и не требует установки сторонних пакетов.

## Лицензия
Этот проект распространяется под лицензией MIT. Подробнее в файле `LICENSE`.

